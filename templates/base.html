<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}–ú–æ–π –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body data-user-id="{{ user_id if user_id else '' }}">
    
    {% block content %}{% endblock %}

    {% if user_id %}
        <!-- –ü–∞–Ω–µ–ª—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞ -->
        <div id="persistent-timer-bar" class="persistent-timer-bar">
            <div class="timer-info">
                <div class="timer-status-indicator">
                    <div class="status-dot"></div>
                    <span id="persistent-status-text">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</span>
                </div>
                <span class="task-name"></span>
                <span class="time-display"></span>
            </div>
            <a href="#" id="return-to-timer-btn" class="button button-small button-primary">–ö —Ç–∞–π–º–µ—Ä—É</a>
        </div>

        <!-- –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ (FAB) -->
        <button id="timer-fab" class="timer-fab" title="–î–µ–π—Å—Ç–≤–∏—è">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
        </button>

        <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –º–µ–Ω—é –¥–ª—è FAB -->
        <div id="timer-fab-menu" class="timer-fab-menu">
            <a href="#" id="fab-menu-session-btn" class="fab-menu-item">–ù–∞—á–∞—Ç—å/–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–µ—Å—Å–∏—é</a>
            <a href="{{ url_for('dynamics', user_id=user_id) }}" class="fab-menu-item">–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ç—á—ë—Ç—É</a>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ó–ê–ü–£–°–ö–ê –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ -->
        <div class="modal-overlay" id="task-modal">
            <div class="modal-content">
                <form id="task-form" method="post" action="#">
                    <h3 class="modal-header">–ù–∞–¥ —á–µ–º –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ?</h3>
                    <div class="form-group">
                        <input type="text" id="task-name-input" name="task_name" class="form-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, '–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ–π —Ñ–∏—á–∏'" required>
                    </div>

                    <h3 class="modal-header" style="margin-top: 24px;">–ì–¥–µ –≤—ã?</h3>
                    <div class="form-group choice-group" id="location-group">
                        <button type="button" class="choice-btn" data-value="–î–æ–º">–î–æ–º</button>
                        <button type="button" class="choice-btn" data-value="–û—Ñ–∏—Å">–û—Ñ–∏—Å</button>
                        <button type="button" class="choice-btn" data-value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</button>
                    </div>

                    <h3 class="modal-header" style="margin-top: 24px;">–ö–∞–∫ –≤—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç–µ?</h3>
                    <div class="form-group choice-group" id="feeling-start-group">
                        <button type="button" class="choice-btn" data-value="–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π">‚ö°Ô∏è –≠–Ω–µ—Ä–≥–∏—á–Ω–æ</button>
                        <button type="button" class="choice-btn" data-value="–°–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π">üéØ –í —Ñ–æ–∫—É—Å–µ</button>
                        <button type="button" class="choice-btn" data-value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ">üôÇ –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ</button>
                        <button type="button" class="choice-btn" data-value="–£—Å—Ç–∞–≤—à–∏–π">ü•± –£—Å—Ç–∞–ª–æ</button>
                    </div>

                    <div class="modal-actions">
                        <button type="button" id="close-task-modal-btn" class="button button-secondary">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="button button-primary">–ù–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- –ù–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –í–û–ó–û–ë–ù–û–í–õ–ï–ù–ò–Ø —Å–µ—Å—Å–∏–∏ -->
        <div class="modal-overlay" id="start-session-modal">
            <div class="modal-content">
                <h3 class="modal-header">–ö–∞–∫ –≤—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã?</h3>
                <div class="form-group choice-group" id="feeling-start-group-resumed">
                    <button type="button" class="choice-btn" data-value="–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π">‚ö°Ô∏è –≠–Ω–µ—Ä–≥–∏—á–Ω–æ</button>
                    <button type="button" class="choice-btn" data-value="–°–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π">üéØ –í —Ñ–æ–∫—É—Å–µ</button>
                    <button type="button" class="choice-btn" data-value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ">üôÇ –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ</button>
                    <button type="button" class="choice-btn" data-value="–£—Å—Ç–∞–≤—à–∏–π">ü•± –£—Å—Ç–∞–ª–æ</button>
                </div>
                 <div class="modal-actions">
                    <button type="button" id="close-start-session-modal-btn" class="button button-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" id="start-resumed-session-btn" class="button button-primary">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ó–ê–í–ï–†–®–ï–ù–ò–Ø —Å–µ—Å—Å–∏–∏ -->
        <div class="modal-overlay" id="end-session-modal">
            <div class="modal-content">
                <h3 class="modal-header">–ö–∞–∫ –≤—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–π—á–∞—Å?</h3>
                <div class="form-group choice-group" id="feeling-end-group">
                    <button type="button" class="choice-btn" data-value="–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π">‚ö°Ô∏è –≠–Ω–µ—Ä–≥–∏—á–Ω–æ</button>
                    <button type="button" class="choice-btn" data-value="–°–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π">üéØ –í —Ñ–æ–∫—É—Å–µ</button>
                    <button type="button" class="choice-btn" data-value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ">üôÇ –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ</button>
                    <button type="button" class="choice-btn" data-value="–£—Å—Ç–∞–≤—à–∏–π">ü•± –£—Å—Ç–∞–ª–æ</button>
                    <button type="button" class="choice-btn" data-value="–ò—Å—Ç–æ—â–µ–Ω–Ω—ã–π">üòµ‚Äçüí´ –ò—Å—Ç–æ—â–µ–Ω–Ω–æ</button>
                </div>
            </div>
        </div>
    {% endif %}

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>
