{% extends "base.html" %}
{% block title %}Главная{% endblock %}

{% block content %}
<main class="dashboard-container">
    <header class="dashboard-header">
        <h1>{{ greeting }}, {{ user_id }}</h1>
        <a href="{{ url_for('login') }}" class="logout-button">Выйти</a>
    </header>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="notification {{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% if analysis_result %}
    <section class="analysis-result">
        <h2>Результат анализа</h2>
        <p>{{ analysis_result }}</p>
    </section>
    {% endif %}

    <section class="thought-form">
        <form method="post" action="{{ url_for('dashboard', user_id=user_id) }}">
            <input type="hidden" name="action" value="save_thought">
            <div class="input-group">
                <label for="thought">Что у вас на уме?</label>
                <textarea id="thought" name="thought" placeholder="Напишите свою мысль здесь..." required></textarea>
            </div>
            <button type="submit" class="button">Отправить</button>
        </form>
    </section>

    <!-- Навигация для ДЕСКТОПА -->
    <nav class="desktop-nav">
        <a href="{{ url_for('thoughts_list', user_id=user_id) }}" class="button button-secondary">Все мысли</a>
        <form method="post" action="{{ url_for('dashboard', user_id=user_id) }}">
            <input type="hidden" name="action" value="analyze">
            <button type="submit" class="button button-secondary">Анализ последних мыслей</button>
        </form>
    </nav>
</main>

<!-- Навигация для МОБИЛЬНЫХ -->
<footer class="mobile-nav">
    <a href="{{ url_for('thoughts_list', user_id=user_id) }}" class="nav-button">
        <span>Все мысли</span>
    </a>
    <form method="post" action="{{ url_for('dashboard', user_id=user_id) }}" class="nav-button">
        <input type="hidden" name="action" value="analyze">
        <button type="submit">
            <span>Анализ</span>
        </button>
    </form>
</footer>
{% endblock %}
